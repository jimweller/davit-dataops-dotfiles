# Configuration Examples

Example configuration files for DataOps Assistant skills. Each skill has its own config directory.

## Directory Structure

```
~/.dataops-assistant/
  k8s/
    clusters.yaml      # Kubernetes cluster overrides
  aws/
    accounts.yaml      # AWS account-to-profile mappings
  steampipe-k8s/       # Generated by k8s-steampipe bootstrap
  steampipe-aws/       # Generated by aws-steampipe-query bootstrap
  steampipe-azure/     # Generated by azure-steampipe-query bootstrap
```

## Setup

Copy the config files for the skills you use:

```bash
# Kubernetes (k8s-steampipe, k8s-logs)
mkdir -p ~/.dataops-assistant/k8s
cp k8s/clusters.yaml ~/.dataops-assistant/k8s/

# AWS (aws-steampipe-query)
mkdir -p ~/.dataops-assistant/aws
cp aws/accounts.yaml ~/.dataops-assistant/aws/
```

## Per-Skill Configuration

### k8s-steampipe / k8s-logs

**Config:** `~/.dataops-assistant/k8s/clusters.yaml`

Overrides/extends the shipped cluster registry with your authentication credentials.

| Field | Purpose |
|-------|---------|
| `anchor` | Cluster identifier (matches shipped registry) |
| `kubeconfig.obtain` | Command that outputs kubeconfig YAML to stdout |
| `kubeconfig.override.users` | Authentication overrides (aws-vault, kubelogin) |

**After editing:** Run `./skills/k8s-steampipe/scripts/bootstrap.sh`

See `k8s/clusters.yaml` for examples.

### aws-steampipe-query

**Config:** `~/.dataops-assistant/aws/accounts.yaml`

Maps account names from the shipped registry to your local AWS profiles.

| Field | Purpose |
|-------|---------|
| `name` | Account name (must exist in shipped registry) |
| `profile` | AWS profile name with credential_process |
| `regions` | Optional region filter (default: all) |

**Prerequisites:**
1. Configure aws-vault with your IAM credentials
2. Add profiles to `~/.aws/config` with `credential_process`:
   ```ini
   [profile sp_dss_common_dev]
   credential_process = aws-vault exec mcg_dev_dev_access --json
   ```

**After editing:** Run `./skills/aws-steampipe-query/scripts/bootstrap.sh`

See `aws/accounts.yaml` for examples.

### azure-steampipe-query

**Runtime:** `~/.dataops-assistant/steampipe-azure/`

No user config required. Uses `az login` credentials to access all Azure subscriptions.

**Prerequisites:**
1. Azure CLI installed (`brew install azure-cli`)
2. Authenticated via `az login`

**Setup:** Run `./skills/azure-steampipe-query/scripts/bootstrap.sh`

The skill ships with subscription config for all company Azure subscriptions.

## Shipped Registries

Skills include default registries that your config extends:

- **Kubernetes:** `lib/k8s/cluster-registry.yaml`
- **AWS:** `skills/aws-steampipe-query/config/account-registry.yaml`
- **Azure:** `skills/azure-steampipe-query/config/*.spc` (no user config needed)

Your user config is merged with these at bootstrap time.
